---
title: '105: Ingestión de datos'
timeToComplete: 45
updated: 2023-09-18T00:00:00.000Z
---
## Ingestión de datos

La ingestión de datos es el proceso de importar y cargar datos en watsonx.data. Hay varios métodos disponibles para ingerir datos en watsonx.data, incluyendo:

• La opción Crear tabla desde archivo en la **Gestor de datos **página

• La edición autónoma y no de desarrollador de watsonx.data incluye un separador de trabajos de Ingestión en la página del gestor de datos, donde los datos se pueden leer de un grupo de almacenamiento de objetos de origen y se pueden ingerir en una tabla. Sin embargo, como este laboratorio utiliza Developer Edition, no está disponible para utilizar aquí.

• Instalación de la herramienta de línea de mandatos ibm-lh y utilizando mandatos para crear un trabajo para ingerir archivos del almacenamiento de objetos compatible con S3 o de un sistema de archivos local.

• Cargar los archivos de datos de una tabla en un grupo de almacenamiento de objetos (si no residen ya en el almacenamiento de objetos), registrar el grupo con watsonx.data y crear una tabla en la parte superior de los archivos utilizando SQL.

En esta sección utilizará la consola MinIO para cargar un archivo de datos de Parquet en el almacenamiento de objetos y, a continuación, creará una tabla en él utilizando SQL en Presto.

1.  Descargar el archivo **aircraft.parquet **archivo de [aquí ](https://ibm.box.com/v/ontime-aircraft-id).
2.  Si usted no tiene ya el **MINIO **consola abierta, ábralo en una nueva ventana del navegador. Utilice las credenciales ( **clave de acceso **y **clave secreta **) usted hizo nota de antes.

Puesto que está cargando un archivo de datos que no está "envuelto" en el formato de tabla Iceberg, necesita utilizar un catálogo de Hive. Utilizará el catálogo de hive\_data existente que está asociado con el grupo de cubetas de colmena.

3.  Pulse la fila para el cubo de la cubeta de la colmena.

![](./images/105/di-hive.png)

4.  En el **Colmena **panel, haga clic en **Crear nueva vía de acceso **.

![](./images/105/di-hive-new.png)

5.  En el **Elegir o crear una nueva vía de acceso **ventana emergente, especifique **myschema2/aircraft **para la **Nueva ruta de carpeta **. A continuación, haga clic en **Crear **.

![](./images/105/di-hive-new-path.png)

Esto va a crear carpetas anidadas bajo el grupo actual. La carpeta de nivel superior ( **myschema2 **) debe coincidir con el nombre del esquema que va a crear más tarde y la siguiente carpeta hacia abajo ( **Aeronave **) debe coincidir con el nombre de la tabla que va a crear más adelante.

6.  Se le indicará que cargue un archivo. Haga clic en **Carga **en la parte superior derecha y, a continuación, haga clic en **Cargar archivo **.

![](./images/105/di-hive-new-upload.png)

> **Nota: **También se le da la opción de subir una carpeta. Si ya tiene un conjunto de archivos en carpetas organizados por esquema y tabla, podría subir la carpeta completa (en cuyo caso no tendría que crear una nueva vía de acceso para la tabla como lo hizo anteriormente, ya que la vía de acceso ya está reflejada en la carpeta que está siendo subido).

7.  Localice, seleccione y cargue el **aircraft.parquet **que ha descargado antes.
8.  Pulse el icono Descargas/Uploads para cerrar el panel Descargas/Uploads.

![](./images/105/di-hive-new-upload-close.png)

9.  Si la carpeta aparece vacía, pulse el botón Renovar en la parte superior derecha. Si la carpeta sigue mostrando como vacía, desplácese hacia arriba un nivel a la carpeta padre ( **myschema2 **) y, a continuación, desplácese hacia abajo a esta carpeta ( **Aeronave **). Si esto todavía no funciona, renueve la ventana del navegador.

![](./images/105/di-hive-new-upload-refresh.png)

El archivo ahora debe ser listado, como en la siguiente imagen.

![](./images/105/di-hive-new-upload-view.png)

10. Cierre la ventana del navegador de la consola MinIO ya que ya no necesita utilizarlo.

Ahora creará un esquema y una tabla para que coincida con el archivo que ha subido. Utilizará la CLI de Presto, pero también puede utilizar la página de espacio de trabajo Consulta en la interfaz web de watsonx.data.

11. Abra una ventana de mandatos de terminal en el servidor watsonx.data como **Raíz **usuario.
12. Ejecute el mandato siguiente para abrir un terminal interactivo de la CLI de Presto.

```bash
  /root/ibm-lh-dev/bin/presto-cli
```

13. Ejecute la sentencia SQL siguiente para crear la **myschema2 **esquema (basado en el catálogo/grupo que se está utilizando y el nombre de carpeta de esquema que ha especificado al subir el archivo al almacenamiento de objetos anteriormente; el nombre de esquema no tiene que coincidir, pero es más fácil gestionar de esta manera).

```bash
  create schema hive_data.myschema2 with (location = 's3a://hive-bucket/myschema2');
```

14. Ejecute la sentencia SQL siguiente para crear la **Aeronave **.

```bash
  create table hive_data.myschema2.aircraft (tail_number varchar, manufacturer varchar, model varchar) with (format = 'Parquet', external_location='s3a://hive-bucket/myschema2/aircraft');
```

15. Valide que la tabla de aeronave se ha creado correctamente consultando el número de filas en él.

```bash
  select count(*) from hive_data.myschema2.aircraft;
```

Se deben devolver 13.101 filas. ¡Su tabla acaba de leer los datos fuera del archivo que ha cargado en el almacenamiento de objetos!

16. Salga de la CLI de Presto ejecutando el mandato siguiente.

```bash
  quit;
```

17. Abra la interfaz de usuario watsonx.data en una ventana del navegador (si todavía no la tiene abierta).
18. Seleccione la opción **Gestor de datos **del menú del lado izquierdo.
19. Expanda el archivo **Catálogo de hive\_data **para ver el nuevo esquema que ha creado ( **myschema2 **).

![](./images/105/watsonx-data-manager.png)

> **Nota: **Si no ve el esquema listado, pase el puntero del ratón por encima de la derecha de la línea para el catálogo hive\_data hasta que aparezca el icono Renovar. Pulse el icono Renovar. Ahora debería ver el esquema listado como en la imagen anterior.

![](./images/105/watsonx-data-manager-refresh.png)

20. Expanda el archivo **myschema2 **esquema para ver la nueva tabla que ha creado ( **Aeronave **).

![](./images/105/watsonx-data-manager-data.png)

La tabla que acaba de crear a través de la CLI de Presto-que se basa en un archivo de datos que ha cargado en el almacenamiento de objetos-es visible a través de la interfaz de usuario watsonx.data. Este es uno de los beneficios de tener una metatienda compartida. En el futuro, cualquier motor de consulta que se asocie al catálogo hive\_data también podría trabajar con esta tabla.

### Felicidades, has llegado al final del laboratorio 105.

Haga clic en [laboratorio 106 ](/watsonx/watsonxdata/106)para iniciar el siguiente laboratorio.
