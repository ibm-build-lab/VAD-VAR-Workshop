---
title: '107: Descarga de datos desde un almacén de datos'
timeToComplete: 45
updated: 2023-09-20T00:00:00.000Z
---
## Descarga de datos desde un almacén de datos

Con watsonx.data, las empresas pueden descargar datos que realmente no necesitan estar en el almacén para un almacenamiento de objetos de menor coste. Con motores aptos para uso, los costes de almacenamiento de datos se pueden reducir al descargar cargas de trabajo de un depósito de datos a watsonx.data. Específicamente, las aplicaciones que necesitan acceder a estos datos pueden consultarlo a través de Presto (o Spark). Esto incluye poder combinar los datos descargados con los datos que permanecen en el almacén. En esta sección se muestra un ejemplo de cómo se puede hacer con Db2 (pero los pasos son equivalentes para otros productos de depósito de datos).

Además, los motores externos que soportan el formato de tabla abierta de Iceberg también pueden funcionar directamente con datos en el almacenamiento de objetos de watsonx.data. Los Últimos Db2 y Netezza también pueden participar en el ecosistema de watsonx.data, accediendo directamente a los datos de lakehouse en el almacenamiento de objetos (tal como puede ser Presto y Spark).

En el [Laboratorio anterior ](/watsonx/watsonxdata/106)ha registrado un entorno de Db2 existente con watsonx.data (llamándolo **Db2DW **) y ha creado un catálogo para él llamado **db2catalog **.

En este caso de ejemplo, usted va a "mover" el **gosalesdw\.sls\_sales\_fact **de Db2 al almacenamiento de objetos de watsonx.data. Se creará como una tabla de Iceberg, en un nuevo esquema que cree llamado **wxgosalesdw **, gestionado por el **Datos de icebert\_data **catálogo.

1.  Seleccione el icono del gestor de datos en el menú del lado izquierdo.
2.  Vaya a la parte superior del panel de navegación y pulse el botón **Crear **menú desplegable. Seleccione **Crear esquema **. (Nota: Estos pasos están utilizando la interfaz web, pero también puede crear un esquema a través de SQL.)

![](./images/107/create-schema.png)

3.  En el **Crear esquema **ventana emergente, selecciona/introduzca la siguiente información y, a continuación, haga clic en el botón Crear:

    *   Catálogo: iceberg\_data
    *   Nombre: wxgosalesdw

![](./images/107/create-schema-save.png)

4.  Expanda el archivo **Datos de icebert\_data **catálogo. Se debe listar el nuevo esquema.

![](./images/107/create-schema-view.png)

5.  Seleccione el icono del espacio de trabajo Consulta en el menú del lado izquierdo.

Para crear una tabla nueva con la misma definición de tabla que la tabla original, puede utilizar la sentencia SQL CREATE TABLE AS SELECT (CTAS).

6.  Copie y pegue el siguiente SQL en el **Hoja de trabajo **Haga clic en **Ejecutar en presto-01 **.

```bash
  create table iceberg_data.wxgosalesdw.sls_sales_fact as select * from db2catalog.gosalesdw.sls_sales_fact;
```

![](./images/107/create-table.png)

El resultado que se muestra en la parte inferior de la hoja de trabajo muestra el número de filas que se han insertado de la tabla fuente a la nueva tabla.

![](./images/107/create-table-result.png)

En un escenario del mundo real, debe eliminar la tabla del depósito de datos. Sin embargo, para mantener intacto el conjunto de datos de ejemplo de Gosalesdw en su entorno, no lo hará aquí.

Como prueba, puede ejecutar una consulta federada que combine la nueva tabla en el almacenamiento de objetos con las tablas existentes en Db2.

7.  Copie y pegue el siguiente SQL en el **Hoja de trabajo **Haga clic en **Ejecutar en presto-01 **.

```bash
  select pll.product_line_en as product, sum(sf.quantity) as total
  from
    db2catalog.gosalesdw.sls_product_dim as pd, 
    db2catalog.gosalesdw.sls_product_line_lookup as pll, 
    hive_data.gosalesdw.sls_sales_fact as sf
  where
    pd.product_key = sf.product_key
    and pll.product_line_code = pd.product_line_code
  group by pll.product_line_en 
  order by product;
```

Esta consulta empresarial calcula las ventas totales para cada una de las líneas de producto de alto nivel. La salida debe ser similar a la siguiente imagen.

![](./images/107/query-result.png)

### Felicidades, has llegado al final del laboratorio 107.

Haga clic en [laboratorio 108 ](/watsonx/watsonxdata/108)para iniciar el siguiente laboratorio.
