---
title: '207: Búsqueda conversacional potenciada por LLM'
timeToComplete: 60
updated: 2024-02-02T00:00:00.000Z
---
# 207: Búsqueda conversacional potenciada por LLM

## En esta sección

Obtenga información sobre la búsqueda conversacional de IBM watsonx Assistant basada en el modelo de lenguaje amplio (LLM): qué es, cómo funciona, cómo configurarlo y cómo utilizarlo.

## Requisitos previos

Esta sección no tiene que realizarse secuencialmente con las otras secciones del laboratorio. Puede utilizar la instancia de watsonx Assistant de las secciones anteriores de este laboratorio o crear una nueva. En esta lección se aprovisionarán los servicios de Assistant y Discovery desde la Zona Tecnológica de IBM (TechZone), por lo que no tendrá que iniciar una prueba de Watson Discovery.

## ¿Qué es la búsqueda conversacional?

Esta sección se centrará en la búsqueda conversacional, una función basada en un gran modelo lingüístico (LLM) que permite al asistente virtual responder a preguntas de forma conversacional sobre una amplia gama de temas.

### Contexto empresarial

Los asistentes virtuales están diseñados para responder a una amplia gama de preguntas frecuentes (FAQs). En watsonx Assistant, los constructores han creado históricamente entre docenas y cientos de *Acciones* para responder a las preguntas más frecuentes.

Con el tiempo, las respuestas cambian a medida que evolucionan los procesos, productos o servicios de una organización. Los creadores deben revisar manualmente de forma periódica las *Acciones* que han creado para asegurarse de que sus respuestas son precisas y están actualizadas.

*Las acciones* que responden a preguntas frecuentes también pueden ser difíciles de crear porque los usuarios finales pueden hacer preguntas de diferentes maneras. Para los creadores puede ser un reto escribir una respuesta que aborde todas estas posibles preguntas sin que suene robótica o poco inteligente.

La búsqueda conversacional ayuda a los constructores a responder más fácilmente a las preguntas frecuentes utilizando IA generativa (en concreto, un LLM) para proporcionar las respuestas. Para garantizar que la IA generativa crea respuestas precisas, relevantes y actualizadas a las preguntas frecuentes, Conversational Search busca primero información relevante en la base de conocimientos de la empresa y, a continuación, introduce esa información en el LLM para que este pueda generar una respuesta basada en la información específica de la empresa.

### Beneficios generales

*   **Tiempo de creación más rápido:** La búsqueda conversacional básicamente automatiza el proceso de respuesta a las preguntas frecuentes. Los creadores ya no tienen que escribir o crear manualmente *acciones* para responder a las preguntas frecuentes, lo que les ahorra decenas de horas de trabajo en la creación inicial.
*   **Requiere menos mantenimiento:** La búsqueda conversacional genera respuestas fundamentadas en la base de conocimientos de la empresa, que contiene la información actualizada más recientemente. Como resultado, los constructores ya no necesitan mantener o actualizar manualmente *las Acciones* para responder a las preguntas frecuentes, lo que les ahorra cientos de horas de mantenimiento.
*   **Las respuestas son realmente conversacionales:** Es poco probable que las respuestas generadas por la búsqueda conversacional suenen robóticas. Se generan en tiempo real como respuesta al estilo único de preguntas del usuario final.

### Marco de trabajo: Generación aumentada por recuperación (RAG)

La búsqueda conversacional utiliza un marco de IA denominado generación aumentada por recuperación (RAG). RAG es un punto de partida muy popular para las empresas que están empezando a desplegar IA generativa.

El GAR tiene dos ventajas principales:

*   Garantiza que el LLM que genera una respuesta a una pregunta tenga acceso a los datos más actuales y fiables relacionados con dicha pregunta.
*   Los usuarios (tanto finales como constructores) tienen acceso a las fuentes del LLM, lo que garantiza que sus respuestas puedan rastrearse, comprobar su exactitud y, en última instancia, ser fiables.

Antes de continuar, y si aún no está familiarizado con RAG, vea este [video](https://www.youtube.com/watch?v=T-D1OfcDW1M) informativo bien hecho o lea este [artículo](https://research.ibm.com/blog/retrieval-augmented-generation-RAG) informativo bien escrito que fueron creados por el equipo de IBM Research.

### Proceso

Existen dos formas generales de implementar RAG en watsonx Assistant. En primer lugar, puede utilizar Conversational Search, la función nativa, lista para usar y sin código integrada en watsonx Assistant. En segundo lugar, puede configurar extensiones personalizadas para configurar una implementación personalizada de RAG con poco código. Este laboratorio se centrará principalmente en Conversational Search, el patrón nativo sin código integrado en watsonx Assistant.

Si el asistente no reconoce una pregunta y no puede responderla utilizando una de sus acciones para las que ha sido entrenado, la pregunta pasará a la Búsqueda conversacional.

A continuación se muestra y explica detalladamente el proceso de búsqueda conversacional:

![](./images/207/convo-search-process.png)

1.  El asistente virtual envía la pregunta del usuario final a una herramienta de búsqueda: en este caso, Watson Discovery. Watson Discovery ha leído y procesado todos los documentos corporativos relevantes.
2.  La herramienta de búsqueda (Watson Discovery) buscará entonces en su contenido y producirá resultados de búsqueda en respuesta a la pregunta.
3.  La herramienta de búsqueda devuelve estos resultados al asistente virtual en una lista.
4.  En este punto, watsonx Assistant podría mostrar los resultados al usuario. Sin embargo, no se parecerían a un discurso natural, sino más bien a un conjunto de resultados de búsqueda. Posiblemente útiles, pero no resumidos y presentados de forma concisa y conversacional.
5.  Por lo tanto, watsonx Assistant envía la pregunta y la lista de resultados de la búsqueda a watsonx, que invoca un LLM.
6.  En algunas implementaciones del GAR, un LLM reordena los resultados de la búsqueda. Puede reordenar o descartar algunos de los resultados de la búsqueda en función de su relevancia y utilidad para la pregunta. Por ejemplo, un LLM puede disminuir la clasificación de un resultado de búsqueda si procede de un documento que no se ha actualizado recientemente, lo que indica que la información puede estar obsoleta. Esta función se denomina a menudo **reordenador neuronal** y pronto estará disponible en la búsqueda conversacional de watsonx Assistant.
7.  El LLM genera una respuesta a la pregunta utilizando la información de los resultados de la búsqueda, y devuelve esta respuesta a watsonx Assistant.
8.  El asistente virtual presenta esta respuesta conversacional al usuario final.

### LLM en búsqueda conversacional

IBM watsonx Assistant **integra** comercial y técnicamente los grandes modelos lingüísticos de watsonx.ai, por lo que los clientes sólo tienen que adquirir watsonx Assistant para integrar la funcionalidad de IA generativa en sus asistentes virtuales.

Otros LLMs watsonx o no watsonx también pueden ser ajustados o diseñados para realizar RAG u otros casos de uso de IA generativa. Estos LLM pueden integrarse con watsonx Assistant mediante extensiones personalizadas. Este patrón puede ser preferible para los clientes que entrenan a sus propios LLM internamente o que desean una funcionalidad personalizada más allá de lo que está disponible de forma nativa en watsonx Assistant a través de la búsqueda conversacional.

### Demostración de la búsqueda conversacional

Esta sección del laboratorio le ofrece dos opciones para implementar la búsqueda conversacional con watsonx Assistant.

La**opción 1** implementa watsonx Assistant, por extensión personalizada, Watson Discovery y Llama 2.

**La opción 2** utiliza la funcionalidad Beta, concretamente la función nativa de Búsqueda Conversacional de watsonx Assistant, que no requiere extensiones personalizadas ni watsonx.ai. La función nativa de búsqueda conversacional es más rápida y fácil de implementar, pero aún está en fase Beta.

Elija la opción más adecuada para su caso de uso o sus necesidades de aprendizaje, y continúe.

## Opción 1: Configurar la búsqueda conversacional en su asistente virtual utilizando Llama2

> **Importante:** Esta sección de este laboratorio asume que usted tiene su TechZone enrionment corriendo.

### Crear un proyecto watsonx

1.  Ir a [watsonx](https://dataplatform.cloud.ibm.com/)

2.  Una vez en la página principal de watsonx, primero, asegúrate de que estás bajo la misma cuenta de TechZone en la que está tu watsonx Assistant.

    > Nota: su cuenta TechZone puede ser diferente de la captura de pantalla.

    ![](./images/207/verify-env.png)

3.  Cree un nuevo proyecto pulsando el botón **+** en **Proyectos**:

    ![](./images/207/new-project.png)

    a. En la pantalla **Nuevo proyecto**:

    *   Introduzca un **nombre** que sea significativo para usted.
    *   Opcionalmente, introduzca una **Descripción**.
    *   El servicio de **almacenamiento de objetos** se rellenará automáticamente (el nombre de su servicio será diferente al de la captura de pantalla).
    *   Haga clic en **Crear**.

    ![](./images/207/create-new-project.png)

4.  Se le redirigirá a la pestaña **Visión general** de su nuevo proyecto watsonx

    ![](./images/207/overview-page.png)

5.  Necesitarás el ID del proyecto watsonx para configurar la acción que llama a la extensión personalizada watsonx en Assistant más adelante. Para obtener el ID de proyecto watsonx, selecciona la pestaña **Gestionar (1** ) y, a continuación, haz clic en **copiar (2)**.

    > Nota: Guarde este ID de proyecto en un bloc de notas por ahora, ya que lo necesitará en breve. Etiquételo correctamente, ya que copiará algunos ID y URL más.

    ![](./images/207/save-project-id.png)

6.  A continuación, vinculará la instancia de servicio Watson Machine Learning aprovisionada automáticamente a este nuevo proyecto watsonx. Para ello, seleccione **Servicios e integraciones (1)** y haga clic en **Asociar servicio + (2)**:

    ![](./images/207/associate-service.png)

7.  En la siguiente pantalla, seleccione la **instancia Watson Machine Learning (1)** y haga clic en **Asociar (2)**.

    > Nota: Su instancia de servicio tendrá un nombre diferente al mostrado en la captura de pantalla.

    ![](./images/207/existing-wml.png)

8.  Para configurar su extensión watsonx en Assistant también necesitará una clave de API de su cuenta de IBM Cloud. Para obtener la clave de API, en una nueva pestaña del navegador:

    *   Vaya a [Gestionar acceso y usuarios - Claves de API en IBM Cloud](https://cloud.ibm.com/iam/apikeys), lo que le llevará a la siguiente pantalla. A continuación, haga clic en **Crear +**.

        ![](./images/207/api-key.png)

    *   En la pantalla emergente Crear clave de API de IBM Cloud, introduzca un **Nombre** y una **Descripción** y, a continuación, haga clic en **Crear**.

        ![](./images/207/create-api-key.png)

    *   Cuando vea que la clave API de notificación se ha creado correctamente, haga clic en **Copiar**:

        ![](./images/207/copy-api-key.png)

        Guarde esta clave API en un lugar seguro y accesible. Necesitará esta clave de API más adelante para configurar la extensión personalizada watsonx en Assistant. Puede cerrar esta pestaña del navegador de IBM Cloud.

### Cargar un documento en Watson Discovery

1.  Vaya a [Mis reservas](https://techzone.ibm.com/my/reservations) en TechZone. Haga clic en el mosaico de su instancia:

    ![](./images/207/instance-tile.png)

2.  Haga clic en la `Watson Discovery URL`

    ![](./images/207/watson-discovery-url.png)

3.  En la página de inicio de Watson Discovery, copie la **clave API (1)** y la **URL del servicio (2)** y guárdelas. Las necesitará para configurar la extensión personalizada Watson Discovery en watsonx Assistant. A continuación, haga clic en **Iniciar Watson Discovery (3)**.

    ![](./images/207/discovery-creds.png)

4.  En la página de bienvenida, haga clic en **Nuevo proyecto +**

    ![](./images/207/new-project-btn.png)

5.  Introduzca un **nombre de proyecto (1)**, como `Lendyr documents`, y seleccione **Recuperación de documentos (2)**; a continuación, haga clic en **Siguiente (3)**.

    ![](./images/207/project-type.png)

6.  Descarga el [documento de preguntas frecuentes de Lendyr](\(https://ibm.seismic.com/app?ContentId=39aeac7d-8d54-4a71-842c-d7ef019f3ee2\)). Este es el archivo que cargarás en Watson Discovery. Una vez descargado, introduzca un **nombre de colección (1)**, como `Lendyr documents`endyr, haga clic en **Arrastrar y soltar archivos aquí o cargar (2)** y pulse **Finalizar (3)**.

    ![](./images/207/create-collection.png)

> Nota: El archivo se carga con relativa rapidez, aunque Watson Discovery puede tardar 15 minutos en procesar el documento. Para supervisar este progreso, haga clic en **Gestionar colecciones** y seleccione el mosaico de la colección de documentos Lendyr

![](./images/207/manage-collections.png)

![](./images/207/collection-tile.png)

La siguiente pantalla muestra el estado de la recogida. El tratamiento finalizará cuando el documento esté disponible.

7.  Obtenga el ID del proyecto Watson Discovery. Lo necesitarás cuando configures la acción watsonx Assistant. Para obtener el ID del proyecto, selecciona **Integrar y desplegar (1)**, haz clic en la pestaña **Información de la API (2)** y copia el **ID del proyecto (3)**. Guárdalo en otro lugar con una etiqueta.

    ![](./images/207/discovery-project-id.png)

Vuelva a la colección de documentos para poder seguir su progreso. Una vez que la pantalla indique **1 Documentos disponibles**, puede pasar al siguiente paso.

![](./images/207/one-doc.png)

8.  Hagamos una pregunta a Watson Discovery. Para ello, haz clic en **Mejorar y personalizar (1)** y, a continuación, escribe `will I earn miles for a balance transfer?` **(2)** en la ventana de consulta. Observa el **resultado de la búsqueda (3)**.

    ![](./images/207/discovery-results.png)

    Watson Discovery proporciona una respuesta útil, pero no conversacional. Este laboratorio aplicará la potencia de los modelos de lenguaje generativo para producir una respuesta más conversacional y sucinta a esta pregunta.

### Configurar el asistente (nueva instancia)

> **Importante:** Si ha completado el laboratorio 6 de esta serie de laboratorios y todavía tiene su entorno TechZone en funcionamiento, sáltese esta parte y vaya al encabezado, `Setup the assistant (existing instance)`.

1.  Vaya a [Mis reservas](https://techzone.ibm.com/my/reservations) en TechZone. Haga clic en el mosaico de su instancia:

    ![](./images/207/instance-tile.png)

2.  En la página de su instancia de TechZone, haga clic en la `Watson Assistant URL`.

    ![](./images/207/watson-assistant-url.png)

3.  En la página de lanzamiento de instancias, haga clic en **Launch watsonx Assistant**:

    ![](./images/207/launch-watson-assistant.png)

4.  Se trata de un asistente nuevo, por lo que primero configurará los aspectos básicos. En primer lugar, introduzca su **nombre (1)**, **descripción (2)** y haga clic en **Siguiente (3)**.

    ![](./images/207/create-assistant.png)

5.  Rellene el formulario en el que se le pregunta cómo utilizará el asistente **(1)** y haga clic en **Siguiente (2)**:

    ![](./images/207/personalize-assistant.png)

6.  La siguiente pantalla le permite personalizar el aspecto del Asistente. Personalícelo como desee y haga clic en el botón **Siguiente**.

    ![](./images/207/customize-assistant.png)

7.  En la siguiente pantalla de vista previa, tienes la opción de **cambiar el fondo (1)**. No lo haremos porque incrustaremos el asistente en el sitio de Lendyr, pero esta es una gran opción para personalizar el aspecto de un asistente para que parezca que está incrustado en el sitio web de un cliente. Haz clic en **Crear (2)**.

    ![](./images/207/background-assistant.png)

> **Importante:** Sáltese la siguiente parte, Configurar el asistente (instancia existente), y vaya directamente al encabezado [Añadir la extensión Watson Discovery](#add-the-watson-discovery-extension).

### Configurar el asistente (instancia existente)

1.  En su asistente Lendyr Lab existente, haga clic en Lendyr Lab y **Crear nuevo +**. Ahora creará un nuevo asistente para esta sección del laboratorio. Más tarde, puede mover esta funcionalidad a su asistente Lendyr Lab original.

    ![](./images/207/create-new.png)

2.  Siga los pasos a partir del paso 4 de la sección [Configurar el asistente (nueva instancia)](#set-up-the-assistant-brand-new-instance) anterior.

### Añada la extensión Watson Discovery

Ahora que tiene una instancia de Watson Discovery configurada, un proyecto watsonx listo y un asistente configurado, puede proceder a añadir las extensiones personalizadas a su asistente.

> Nota: Las extensiones se trataron en detalle en el laboratorio 5 de esta serie de laboratorios.

1.  Para la extensión Watson Discovery, descarga la especificación OpenAPI [watson-discovery-query-openapi.json](https://ibm.seismic.com/app?ContentId=6a2530bc-5cac-4768-9654-8684b73c8357). Esta es la especificación API para la extensión personalizada Watson Discovery.

2.  En watsonx Assistant, utilice el menú de la izquierda para abrir la página **Integraciones (1)**. A continuación, desplázate hacia abajo y haz clic en el botón **Crear extensión personalizada (2)**:

    ![](./images/207/build-custom-extension.png)

3.  Esta primera pantalla describe lo que necesitarás para crear la extensión. Tenga en cuenta que el documento OpenAPI JSON, que acaba de obtener, es clave para la configuración. Haga clic en **Siguiente** para pasar a la siguiente pantalla.

    ![](./images/207/custom-extension-started.png)

4.  La segunda pantalla le pide que nombre y describa la extensión personalizada. Nombre la extensión `Watson Discovery custom extension` `Custom extension exposing all of Watson Discovery’s APIs` `Watson Discovery custom extension` **(1)** y añada una descripción, como `Custom extension exposing all of Watson Discovery’s APIs` **(2)**. Haga clic en **Siguiente (3)** para pasar a la siguiente pantalla.

    ![](./images/207/custom-extension-info.png)

5.  En la siguiente pantalla, arrastre y suelte o haga clic para cargar la especificación OpenAPI [watson-discovery-query-openapi.json](https://ibm.seismic.com/app?ContentId=6a2530bc-5cac-4768-9654-8684b73c8357) que ha descargado **(1)** y, a continuación, haga clic en **Siguiente (2)** para pasar a la siguiente pantalla:

    ![](./images/207/import-open-api.png)

> **Nota:** Si obtiene un error que indica que el archivo no tiene el formato JSON adecuado, intente descargarlo de nuevo con otro navegador y asegúrese de que tiene la extensión `.json`.

6.  Tómese un momento para revisar la extensión en la siguiente pantalla. Esta extensión nos permitirá llamar a Watson Discovery utilizando su **API Key (1)** que obtuviste anteriormente. Haga clic en **Finalizar (2)**

    ![](./images/207/review-extension.png)

7.  Ahora debería poder ver la extensión **personalizada Watson Discovery (1)** en su catálogo de integraciones:

    Ten en cuenta que es diferente de la extensión **IBM Watson Discovery (2)**, que normalmente se utiliza como habilidad de búsqueda de Assistant. La habilidad personalizada ofrece a watsonx un acceso más completo a las API de Watson Discovery que el que proporciona la habilidad de búsqueda. Haz clic en **Añadir + (3)**.

    ![](./images/207/add-extension.png)

    > **¿Por qué no utilizo la** extensión de búsqueda [integrada](https://cloud.ibm.com/docs/watson-assistant?topic=watson-assistant-search-add) de Watson Discovery? Una alternativa a la creación de una extensión personalizada de Watson Discovery es utilizar la [integración de búsqueda integrada](https://cloud.ibm.com/docs/watson-assistant?topic=watson-assistant-search-add) (también denominada habilidad de búsqueda de Watson Assistant). Es más fácil de integrar, pero no expone ni utiliza todos los parámetros de la API ni toda la potencia de Watson Discovery que utilizará watsonx. Por ejemplo, Watson Discovery proporciona una *confianza* de respuesta para cada respuesta que proporciona una estimación de la probabilidad de que la respuesta sea correcta, por lo que un usuario de Watson Discovery puede utilizar esa probabilidad para decidir si la respuesta es lo suficientemente plausible como para que deba destacarse. La integración de búsqueda incorporada en Watson Assistant no expone la confianza de la respuesta porque está diseñada para proporcionar una funcionalidad simple y mínima.

8.  Ha creado la extensión personalizada Watson Discovery y ahora necesita especificar a qué instancia de Watson Discovery accederá. En la ventana emergente, haga clic en **Añadir**.

    ![](./images/207/add-btn.png)

9.  En la siguiente pantalla, puede leer cómo añadir la extensión personalizada. Cuando esté listo, haga clic en **Siguiente**:

    ![](./images/207/next-btn.png)

10. La siguiente pantalla solicita los detalles de **autenticación**:

    1.  Seleccione **Autenticación básica** como tipo de autenticación.
    2.  En el campo **Nombre de usuario**, introduzca `apikey`.
    3.  En el campo **Contraseña** introduzca la **Clave API Discovery** que guardó anteriormente.
    4.  En la parte inferior del panel Autenticación, en **discovery\_url**, introduzca la URL de su instancia Discovery que guardó anteriormente. Asegúrate de introducirla sin el prefijo *https\://*.
    5.  Haga clic en **Siguiente**.

    ![](./images/207/auth-details.png)

11. Verá un resumen de su nueva extensión personalizada. Haga clic en **Finalizar**:

    ![](./images/207/finish-btn.png)

### Añadir la extensión personalizada watsonx

A continuación, crearás la extensión personalizada watsonx. En primer lugar, descarga el [archivo de especificación OpenAPI](https://ibm.seismic.com/app?ContentId=8481fd6e-c038-4313-b213-7f160f0c35c3) de watsonx. Este archivo JSON define la extensión personalizada watsonx.

1.  En watsonx Assistant, utilice el menú de la izquierda para abrir la página **Integraciones (1)**. A continuación, desplázate hacia abajo y haz clic en el botón **Crear extensión personalizada (2)**:

    ![](./images/207/build-custom-extension.png)

2.  Esta primera pantalla describe lo que necesitarás para crear la extensión. Tenga en cuenta que el documento watsonx OpenAPI JSON, que acaba de obtener, es clave para la configuración. Haga clic en **Siguiente** en la parte superior derecha para pasar a la siguiente pantalla:

    ![](./images/207/custom-extension-started.png)

3.  La segunda pantalla le pide que nombre y describa la extensión personalizada. Nómbrela extensión personalizada `watsonx custom extension` **(1)** y añada una descripción, como `Custom extension for watsonx` **(2)**. Haga clic en **Siguiente (3)** para pasar a la siguiente pantalla.

    ![](./images/207/watsonx-extension.png)

4.  En la siguiente pantalla, arrastre y suelte o haga clic para cargar el [archivo de especificación OpenAPI watsonx](https://ibm.seismic.com/app?ContentId=8481fd6e-c038-4313-b213-7f160f0c35c3) **(1)** que ha descargado y, a continuación, haga clic en **Siguiente (2)** para pasar a la siguiente pantalla.

    ![](./images/207/upload-watsonx-api.png)

> **Nota:** Si obtiene un error que indica que el archivo no está en el formato JSON adecuado, intente descargarlo de nuevo con otro navegador y asegúrese de que tiene la extensión **.json**, en minúsculas.

5.  Haga clic en **Finalizar** para crear la extensión personalizada.

    ![](./images/207/watsonx-finish.png)

6.  Ahora debería poder ver la **extensión personalizada watsonx (1)** en su catálogo de integraciones. Haz clic en **Añadir + (2)** para poder configurar una conexión con tu proyecto watsonx:

    ![](./images/207/watsonx-add.png)

7.  Haga clic en **Añadir** en la pantalla emergente.

    ![](./images/207/watsonx-add-btn.png)

8.  Pulsa **Siguiente** en la siguiente pantalla:

    ![](./images/207/watsonx-next-btn.png)

9.  En la pantalla Autenticación:

    1.  Elija **OAuth 2.0** como tipo de autenticación.

    2.  Seleccione **Custom apikey** como tipo de subvención.

    3.  Copie y pegue la [clave de API](https://cloud.ibm.com/iam/apikeys) de **IBM Cloud** que guardó anteriormente en el campo Apikey.

    4.  Haga clic en **Siguiente**.

        ![](./images/207/watsonx-auth.png)

10. Haga clic en **Finalizar**.

    ![](./images/207/watsonx-finish-btn.png)

### Cargar y configurar las acciones watsonx

1.  A continuación, subirá las acciones que necesitará su asistente, así que descargue el [archivo JSON de acciones](https://ibm.seismic.com/app?ContentId=68403304-51c2-430f-88a0-90ce20a28b22).

> **Nota:** No debe cargar estas acciones directamente en un asistente existente porque al hacerlo se sobrescribirán sus acciones existentes.

> **Nota:** Si el archivo se descarga con una extensión **.JSON** en mayúsculas, debe renombrarlo a **.json** en minúsculas, de lo contrario no se cargará correctamente.

| **Acción**                                | **Descripción**                                                                                                                                                                                                                                                                                                                                                                                         |
| ----------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| *Buscar en*                               | Se conecta a Watson Discovery para buscar documentos relacionados con la consulta del usuario. La acción "out-of-box **No Action Matches** " ha sido configurada para enviar todas las entradas a esta acción, por lo que lo que el usuario introduzca se utilizará como entrada de la búsqueda. A su vez, esta acción invoca la acción **Generar respuesta** para generar una respuesta a la consulta. |
| *Generar respuesta*                       | Configura la consulta y los pasajes del documento resultantes de la acción Buscary llama a la acción **Invocar API de generación de watsonx.** No está pensada para ser invocada directamente, sino por la acción **Buscar**.                                                                                                                                                                           |
| *Invocar la API de generación de watsonx* | Se conecta a watsonx y, utilizando como contexto los documentos resultantes de la búsqueda, pide al modelo lingüístico que genere una respuesta a la consulta del usuario. No está pensada para ser invocada directamente, sino mediante la acción **Generar respuesta**                                                                                                                                |

Las acciones de este archivo utilizarán la búsqueda sólo cuando ninguna acción coincida con la solicitud del usuario. Buscan en un proyecto watsonx completo y, como tales, son de uso general y pueden utilizarse con cualquier conjunto de datos.

2.  Para cargar el archivo JSON, haga clic en **Acciones (1)** y, a continuación, en **Configuración global (2)**:

    ![](./images/207/global-settings.png)

3.  Desplácese hacia la derecha hasta que pueda ver y seleccionar la pestaña **Cargar/Descargar (1)**. Allí, **arrastre y suelte (2)** el [archivo JSON de las acciones](https://ibm.seismic.com/app?ContentId=68403304-51c2-430f-88a0-90ce20a28b22) y haga clic en **Cargar (3)**:

    ![](./images/207/upload-actions.png)

4.  Haga clic en **Cargar y sustituir** en la pantalla emergente de advertencia.

    ![](./images/207/upload-replace.png)

5.  Pulsa **Cerrar**.

    ![](./images/207/close-btn.png)

El archivo JSON de acciones que ha cargado también incluye variables utilizadas por las acciones. Debe actualizar dos de ellas con sus ID de proyecto Discovery y watsonx.

6.  Dentro de la página Acciones, en Variables, seleccione el filtro **Creado por usted (1)**, que muestra las variables que acaba de cargar. Haga clic en la variable de sesión **discovery\_project\_id (2)**:

    ![](./images/207/discovery-id-var.png)

7.  Copie y pegue el valor del **ID del proyecto (1)** que obtuvo al configurar Watson Discovery y haga clic en **Guardar (2)**.

    ![](./images/207/save-session-var.png)

8.  Haga clic en la variable **watsonx\_project\_id**:

    ![](./images/207/watsonx-project-id-var.png)

9.  Establezca la variable **watsonx\_project\_id (1** ) con el ID del proyecto watsonx que obtuvo anteriormente y haga clic en **Guardar (2)**. Esto indica al asistente qué proyecto watsonx se utilizará para generar las respuestas.

    ![](./images/207/watsonx-project-id-save.png)

### Probemos el Asistente watsonx

1.  Haga clic en **Vista previa (1)** e introduzca la misma pregunta que antes: `will I earn miles for a balance transfer?` **(2)**.

    Observe la respuesta clara, concisa y conversacional. Compárela con el extracto de la respuesta de Watson Discovery.

    ![](./images/207/preview-question.png)

2.  En la página **Vista previa** (mostrada arriba), haga clic en **Personalizar chat web (3)**. A continuación, como se muestra a continuación:

    a. Haga clic en la pestaña **Incrustar**.

    b. Copie el valor del **ID de integración** de su asistente y péguelo en un documento de texto. Utilizará este valor en breve.

    c. Copie el valor de la **región** de su asistente y péguelo en un documento de texto. Utilizará este valor en breve.

    d. Copie el valor de **serviceInstanceId** de su asistente y péguelo en un documento de texto. Utilizará este valor en breve.

    e. Por último, haga clic en **Cerrar**.

    ![](./images/207/embed-website.png)

3.  Ahora, toma el **integrationID**, la **región** y **el serviceInstanceId** de tu asistente e introdúcelos en esta URL:

    `https://www.ibm.com/products/watson-assistant/demos/lendyr/demo.html?integrationID=ID_HERE&region=REGION_HERE&serviceInstanceID=ID_HERE`

    Asegúrate de que no haya espacios (¡cada pegada añade un espacio!), y luego copia y pega tu URL personalizada en tu navegador.

    Si desea realizar una demostración de las funciones incorporadas en esta sección, consulte el [vídeo de demostración](https://ibm.seismic.com/app?ContentId=284b5973-427c-43c5-a672-98881791925f) para ver un flujo recomendado con otras expresiones para preguntar al asistente.

    ¡Enhorabuena! Ya ha creado la demostración y la funcionalidad que se muestran en el [vídeo de demostración](https://ibm.seismic.com/app?ContentId=284b5973-427c-43c5-a672-98881791925f).

### Copia la nueva funcionalidad a tu asistente Lendyr

> **Nota:** Hay dos requisitos previos para poder completar esta última parte del laboratorio. Si ambos no se aplican, usted ha terminado con este laboratorio.
>
> 1.  Debe haber completado los laboratorios 1 a 7 de la serie de laboratorios.
> 2.  Ambos asistentes deben ejecutarse en la misma instancia de watsonx Assistant (en otras palabras, en el mismo entorno TechZone o en la misma instancia con el mismo ID de usuario de IBM Cloud).

Puedes copiar la funcionalidad de búsqueda potenciada por LLM que acabas de crear en tu versión del asistente virtual Lendyr que construiste en las secciones de laboratorio anteriores.

> No cargue las acciones en el asistente que construyó previamente; esto sobrescribirá sus acciones existentes. En su lugar, [copie y pegue](https://cloud.ibm.com/docs/watson-assistant?topic=watson-assistant-copy-action) las acciones.

1.  En primer lugar, navega a tu asistente Lendyr Lab, construido en los laboratorios 1-6. Allí, vuelve a configurar las extensiones watsonx y Watson Discovery siguiendo las partes respectivas de esta sección:

    *   [Añade la extensión Watson Discovery](#add-the-watson-discovery-extension).
    *   [Añade la extensión personalizada watsonx](#add-the-watsonx-custom-extension).

2.  Vuelve a la página Acciones de tu nuevo asistente virtual (con tecnología LLM). Seleccione **(1** ) cada una de las tres acciones, de una en una, y seleccione [Copiar al asistente](https://cloud.ibm.com/docs/watson-assistant?topic=watson-assistant-copy-action) **(2)**:

    ![](./images/207/copy-assistant-btn.png)

3.  En la pantalla emergente, compruebe que está pegando su asistente de Lendyr Lab y haga clic en **Siguiente**

    ![](./images/207/destination-assistant.png)

4.  En la siguiente pantalla, compruebe que no hay "conflictos" y haga clic en **Aplicar**:

    ![](./images/207/apply-btn.png)

El asistente virtual puede pedirle que seleccione *Sobrescribir* o *Guardar como nuevo* para acciones y variables. Tendrá selecciones predeterminadas para cada acción y variable. No cambie las selecciones predeterminadas.

5.  Cambia al asistente Lendyr que creaste en los laboratorios 1-6 **(1)** y navega hasta la página **Acciones (2)**.

    Aquí creará una acción que preguntará al usuario si desea intentar la búsqueda conversacional cuando el asistente no reconozca la pregunta. Para crear esta acción, haga clic en **Establecer por asistente (1)** y, a continuación, abra la acción **Ninguna acción coincide (2)**:

    ![](./images/207/no-action-matches.png)

6.  Como se muestra a continuación:

    1.  Añadir un **nuevo paso +**.

    2.  Arrástralo hacia arriba para que sea el primer paso.

    3.  Bajo **Asistente dice**, escribir: `I'm not sure I have a pre-defined answer on that topic. Would you like me to search my knowledge base for an answer?`

    4.  **Defina la respuesta del cliente** como una Confirmación.

        ![](./images/207/confirmation-step.png)

7.  A continuación, añade otro paso:

    1.  Añadir un **nuevo paso +**.

    2.  Arrástralo hacia arriba para que sea el segundo paso.

    3.  Añada la **condición**: Si el Paso 1 es Sí.

    4.  Bajo **Asistente dice**, escribe: `OK!`.

        ![](./images/207/step-2.png)

    5.  Desplácese hasta la parte inferior y cambie **Y luego** a **Ir a una subacción**.

        ![](./images/207/subaction.png)

    6.  En la ventana de búsqueda de subacciones que aparece, seleccione **Buscar (1)** como subacción, marque la casilla **Finalizar esta acción una vez completada la otra acción (2)** y haga clic en **Aplicar (3)**:

        ![](./images/207/subaction-window.png)

8.  Por último, añade otro paso:

    1.  Añade otro **Nuevo paso +**.

    2.  Arrástralo hacia arriba para que sea el tercer paso.

    3.  Añada la **condición**: Si el Paso 1 es No.

    4.  Bajo **Asistente dice**, escribe: `OK! In that case:` caso:.

    5.  **Guarda** la acción.

        ![](./images/207/convo-search-step.png)

    Su asistente virtual Lendyr ahora preguntará al usuario final si desea probar la búsqueda conversacional cuando el asistente virtual no reconozca su pregunta.

## Opción 2: Configuración de la búsqueda conversacional nativa (Beta) mediante IBM Granite

Vamos a ver cómo configurar la búsqueda conversacional nativa de watsonx Assistant, que no requiere el uso de extensiones personalizadas o watsonx.ai. Esta capacidad de búsqueda conversacional nativa es rápida y fácil de implementar, pero todavía está en [fase Beta](https://cloud.ibm.com/docs/watson-assistant?topic=watson-assistant-conversational-search).

En esta sección del laboratorio, usted continuará trabajando con el asistente que ha estado construyendo en las Secciones 1-6 de este laboratorio o - si usted no ha hecho las Secciones 1-6 - creará un asistente completamente nuevo.

### Solicita que se active la función dark beta en Watson Discovery

> **Importante:** En esta sección del laboratorio se presupone que el entorno TechZone está en funcionamiento.

La Búsqueda Conversacional nativa es una característica beta oscura y debe ser [solicitada](https://form.asana.com/?k=U0gIIpwhM2_LY8r8LC_qDw\&d=8612789739828) para que esté disponible por instancia. La aprobación puede tardar unos **2 días laborables**.

El formulario requiere que proporcione la URL de la instancia del servicio Watson Discovery. Puede encontrar la URL de la instancia de servicio siguiendo estos pasos:

1.  Vaya a [Mis reservas](https://techzone.ibm.com/my/reservations) en TechZone. Haga clic en el mosaico de su instancia:

    ![](./images/207/instance-tile.png)

2.  En la página de su instancia de TechZone, haga clic en la `Watson Assistant URL`.

    ![](./images/207/watson-assistant-url.png)

3.  En la página de inicio de watsonx Assistant, copie la **URL de** la instancia de servicio.

    ![](./images/207/assistant-service-url.png)

4.  Pegue la URL en el campo **URL de la Instancia de Servicio**:

    ![](./images/207/beta-form.png)

Una vez aprobada la solicitud, recibirá un correo electrónico similar al que se muestra a continuación:

![](./images/207/beta-email.png)

Después de la aprobación Beta, puede continuar con el resto de este laboratorio.

### Cargar un documento en Watson Discovery

1.  Vaya a [Mis reservas](https://techzone.ibm.com/my/reservations) en TechZone. Haga clic en el mosaico de su instancia:

    ![](./images/207/instance-tile.png)

2.  Haga clic en la `Watson Discovery URL`

    ![](./images/207/watson-discovery-url.png)

3.  En la página de inicio de Watson Discovery, copie la **clave API (1)** y la **URL del servicio (2)** y guárdelas. Las necesitará para configurar la extensión personalizada Watson Discovery en watsonx Assistant. A continuación, haga clic en **Iniciar Watson Discovery (3)**.

    ![](./images/207/discovery-creds.png)

4.  En la página de bienvenida, haga clic en **Nuevo proyecto +**

    ![](./images/207/new-project-btn.png)

5.  Introduzca un **nombre de proyecto (1)**, como `Lendyr documents`, y seleccione **Recuperación de documentos (2)**; a continuación, haga clic en **Siguiente (3)**.

    ![](./images/207/project-type.png)

6.  Descarga el [documento de preguntas frecuentes de Lendyr](\(https://ibm.seismic.com/app?ContentId=39aeac7d-8d54-4a71-842c-d7ef019f3ee2\)). Este es el archivo que cargarás en Watson Discovery. Una vez descargado, introduzca un **nombre de colección (1)**, como `Lendyr documents`, haga clic en **Arrastrar y soltar archivos aquí o cargar (2)** y pulse **Finalizar (3)**.

    ![](./images/207/create-collection.png)

> Nota: El archivo se carga con relativa rapidez, aunque Watson Discovery puede tardar 15 minutos en procesar el documento. Para supervisar este progreso, haga clic en **Gestionar colecciones** y seleccione el mosaico de la colección de documentos Lendyr

![](./images/207/manage-collections.png)

![](./images/207/collection-tile.png)

La siguiente pantalla muestra el estado de la recogida. El tratamiento finalizará cuando el documento esté disponible.

7.  Obtenga el ID del proyecto Watson Discovery. Lo necesitarás cuando configures la acción watsonx Assistant. Para obtener el ID del proyecto, selecciona **Integrar y desplegar (1)**, haz clic en la pestaña **Información de la API (2)** y copia el **ID del proyecto (3)**. Guárdalo en otro lugar con una etiqueta.

    ![](./images/207/discovery-project-id.png)

Vuelva a la colección de documentos para poder seguir su progreso. Una vez que la pantalla indique **1 Documentos disponibles**, puede pasar al siguiente paso.

![](./images/207/one-doc.png)

8.  Hagamos una pregunta a Watson Discovery. Para ello, haz clic en **Mejorar y personalizar (1)** y, a continuación, escribe `will I earn miles for a balance transfer?` **(2)** en la ventana de consulta. Observa el **resultado de la búsqueda (3)**.

    ![](./images/207/discovery-results.png)

    Watson Discovery proporciona una respuesta útil, pero no conversacional. Este laboratorio aplicará la potencia de los modelos de lenguaje generativo para producir una respuesta más conversacional y sucinta a esta pregunta.

### Configurar el asistente (nueva instancia)

> **Importante:** Si ha completado el laboratorio 6 de esta serie de laboratorios y todavía tiene su entorno TechZone en funcionamiento, sáltese esta parte y vaya al encabezado, [Utilice su asistente existente](#use-your-existing-assistant).

1.  Vaya a [Mis reservas](https://techzone.ibm.com/my/reservations) en TechZone. Haga clic en el mosaico de su instancia:

    ![](./images/207/instance-tile.png)

2.  En la página de su instancia de TechZone, haga clic en la `Watson Assistant URL`.

    ![](./images/207/watson-assistant-url.png)

3.  En la página de lanzamiento de instancias, haga clic en **Launch watsonx Assistant**:

    ![](./images/207/launch-watson-assistant.png)

4.  Se trata de un asistente nuevo, por lo que primero configurará los aspectos básicos. En primer lugar, introduzca su **nombre (1)**, **descripción (2)** y haga clic en **Siguiente (3)**.

    ![](./images/207/create-assistant.png)

5.  Rellene el formulario en el que se le pregunta cómo utilizará el asistente **(1)** y haga clic en **Siguiente (2)**:

    ![](./images/207/personalize-assistant.png)

6.  La siguiente pantalla le permite personalizar el aspecto del Asistente. Personalícelo como desee y haga clic en el botón **Siguiente**.

    ![](./images/207/customize-assistant.png)

7.  En la siguiente pantalla de vista previa, tienes la opción de **cambiar el fondo (1)**. No lo haremos porque incrustaremos el asistente en el sitio de Lendyr, pero esta es una gran opción para personalizar el aspecto de un asistente para que parezca que está incrustado en el sitio web de un cliente. Haz clic en **Crear (2)**.

    ![](./images/207/background-assistant.png)

> **Importante:** Sáltese la parte siguiente, *Utilizar su asistente actual*, y vaya directamente al encabezado [Añadir la extensión de búsqueda](#add-the-search-extension).

### Utilice su asistente actual

Cuando utilice su instancia existente, hay dos pasos para desplegar la funcionalidad de Búsqueda Conversacional:

1.  Añada la extensión Search, que se conectará a su instancia de Watson Discovery.
2.  Invocar la Búsqueda Conversacional a través de una o más Acciones.

Abra su instancia existente de Assistant y proceda a _Añadir la extensión de búsqueda_

### Añadir la extensión Search

Ahora que ya tienes configurada una instancia de Watson Discovery y un asistente, puedes proceder a añadir la extensión de búsqueda a tu asistente.

1.  En watsonx Assistant, utiliza el menú de la izquierda para abrir la página **Integraciones (1)**. A continuación, desplázate hacia abajo y haz clic en el botón **Añadir + (2)**:

    ![](./images/207/search-tile.png)

2.  Seleccione la extensión de búsqueda Watson Discovery:

    ![](./images/207/watson-discovery-tile.png)

3.  Seleccione la instancia de Watson Discovery en la que cargó las FAQs de Lendyr **(1)**, seleccione el proyecto de **documentos de Lendyr** **(2)** y haga clic en **Siguiente (3)**:

    ![](./images/207/search-integration.png)

En la siguiente pantalla se asigna el esquema de datos de Watson Discovery a los campos de título, cuerpo y URL que utilizará watsonx Assistant. (Revise la documentación del producto [aquí](https://cloud.ibm.com/docs/watson-assistant/watson-assistant?topic=watson-assistant-search-add#search-add-configure) para obtener más información sobre las opciones de esta pantalla; en este laboratorio dejará los valores predeterminados).

4.  En primer lugar, pruebe la integración de la búsqueda en la ventana Vista previa escribiendo: `Will I earn miles for a balance transfer?` **(1)**.

    Tenga en cuenta que la respuesta es más o menos la misma que obtuvo anteriormente en Watson Discovery:

    ![](./images/207/toggle-beta.png)

    La integración de Watson Discovery con watsonx Assistant se ha completado con éxito. Para ello, cambia la búsqueda conversacional de **desactivada a activada (2)** y haz clic en **Guardar (3)**.

### Añadir un paso de búsqueda a una acción

En este laboratorio, usted configurará la Búsqueda Conversacional para invocarla cuando el asistente no pueda hacer coincidir la pregunta del usuario final con una de las Acciones. La forma más sencilla de hacerlo es añadir un Paso a una Acción que se proporciona automáticamente con cada instancia del Asistente: la acción _Ninguna acción coincide_.

1.  Para ello, haga clic en las acciones **establecidas por el asistente (2)** y seleccione la acción **Ninguna acción coincide (3)**:

    ![](./images/207/no-action-matches.png)

2.  A continuación, como se muestra a continuación:

    1.  Haz clic en **Nuevo paso +**.
    2.  Asegúrese de que este nuevo paso es el primero de la secuencia (puede arrastrarlo y soltarlo en la lista).
    3.  En **Y luego** seleccione **Buscar la respuesta**.

    ![](./images/207/search-for-answers.png)

3.  A continuación, haga clic en **Editar configuración (1)** y, en la ventana emergente, seleccione **Finalizar la acción tras devolver los resultados (2)** y haga clic en **Aplicar (3)**:

    ![](./images/207/edit-settings.png)

4.  Guarda la acción.

### Pruébelo.

Ahora que ha terminado de configurar su asistente, ¡pruébelo! Haz clic en **Vista previa** e introduce estas preguntas. Ninguna de las acciones ha sido entrenada para responder a estas preguntas:

*   `Will I earn miles for a balance transfer?`
*   `What is Lendyr Bank’s routing number for electronic transactions?`
*   `How can I get the 20% discount with the Lendyr AirMiles credit card?`
*   `Can I order checks for my Checking account?`
*   `Does FDIC insurance cover my brokerage account?`
*   `Where can I learn more about what FDIC covers?`?

\*No hay respuestas a estas preguntas en las FAQs que subiste a Watson Discovery; la respuesta la proporciona el IBM Granite Large Language Model.

![](./images/207/granite-beta-answers.png)

Observe las respuestas claras, concisas y conversacionales. Compárelo con el extracto de la respuesta de Watson Discovery.

Has completado esta sección del laboratorio, que también concluye esta serie de laboratorios. Has cubierto los conceptos fundamentales y las características de watsonx Assistant, y estás bien equipado para construir y probar un asistente virtual simple y potente - ¡con algo de práctica, por supuesto!
