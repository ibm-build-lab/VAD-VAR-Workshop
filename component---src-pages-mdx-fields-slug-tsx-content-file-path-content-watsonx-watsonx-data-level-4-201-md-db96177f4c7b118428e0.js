"use strict";(self.webpackChunkvad_var_site=self.webpackChunkvad_var_site||[]).push([[7022],{15473:function(e,t,n){n.r(t),n.d(t,{Head:function(){return g},default:function(){return E}});var a=n(11151),l=n(67294);function o(e){const t=Object.assign({section:"section",h1:"h1",p:"p",a:"a",h2:"h2",strong:"strong",ol:"ol",li:"li",ul:"ul",code:"code",img:"img",pre:"pre",blockquote:"blockquote",span:"span",em:"em"},(0,a.ah)(),e.components),{QuizAlert:n}=t;return n||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("QuizAlert",!0),l.createElement(t.section,{className:"heading","data-heading-rank":"1","aria-labelledby":"201-apache-spark-with-watsonxdata"},l.createElement(t.h1,{id:"201-apache-spark-with-watsonxdata"},"201: Apache Spark with watsonx.data"),"\n",l.createElement(t.p,null,"This lab showcases how IBM watsonx.data can integrate with Apache Spark as a query engine.\nThe lab environment uses the watsonx.data Developer Edition image in an IBM TechZone\nprovisioned environment. This can be found here:"),"\n",l.createElement(t.p,null,l.createElement(t.a,{href:"https://techzone.ibm.com/collection/ibm-watsonxdata-developer-base-image/environments"},"https://techzone.ibm.com/collection/ibm-watsonxdata-developer-base-image/environments")),"\n",l.createElement(t.p,null,"For this lab’s exercises, Apache Spark is running separately within the\nimage (it was not part of the product at the time this lab was written; this document will be\nupdated when it is). IBM watsonx.data Software as a Service (SaaS) offerings of watsonx.data on\nIBM Cloud and Amazon Web Services (AWS), requires Apache Spark to be provisioned as a\nseparate service (",l.createElement(t.a,{href:"https://cloud.ibm.com/catalog/services/analytics-engine"},"IBM Analytics Engine")," is the Apache Spark Service on IBM Cloud)."),"\n",l.createElement(t.p,null,"This lab requires that you have a watsonx.data environment already up and running. See the\nPrerequisites & Getting Started section for details."),"\n",l.createElement(t.p,null,"Watsonx.data is being developed and released in an agile manner. In addition to new\ncapabilities being added, the web interface is also likely to change over time. Therefore, the\nscreenshots used in this lab may not always look exactly like what you see."),"\n",l.createElement(t.section,{className:"heading","data-heading-rank":"2","aria-labelledby":"getting-help"},l.createElement(t.h2,{id:"getting-help"},l.createElement(t.a,{href:"#getting-help"},"Getting Help")),"\n",l.createElement(t.p,null,l.createElement(t.strong,null,"Lab guide help"),": If you require assistance in interpreting any of the steps in this lab, please post\nyour questions to the #data-ai-demo-feedback Slack channel (IBMers only). Business Partners\ncan request help at the Partner Plus Support website."),"\n",l.createElement(t.p,null,l.createElement(t.strong,null,"TechZone environment"),": If you encounter any issues regarding the TechZone environment being\nused in this lab, including the inability to provision an environment, please see the ",l.createElement(t.a,{href:"https://techzone.ibm.com/help"},"TechZone\nHelp")," page."),"\n",l.createElement(t.p,null,l.createElement(t.strong,null,"watsonx.data"),": Assistance with the watsonx.data product itself is available in the #watsonxdata-lakehouse-discussion-open-to-all-ibmers Slack channel (IBMers only). Additionally, please refer to the watsonx.data documentation as needed (SaaS, software)."),"\n"),l.createElement(t.section,{className:"heading","data-heading-rank":"2","aria-labelledby":"getting-started"},l.createElement(t.h2,{id:"getting-started"},l.createElement(t.a,{href:"#getting-started"},"Getting Started")),"\n",l.createElement(t.ol,null,"\n",l.createElement(t.li,null,"Copy the required contents of the IBM TechZone environment ",l.createElement(t.strong,null,'"Published services"')," details into a text document so that the information is easily accessible during the lab exercise. The\nfollowing information is required for this Spark lab:"),"\n"),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,l.createElement(t.strong,null,"SSH for watsonx User ID")," – ",l.createElement(t.code,null,"ssh -p 00000 watsonx@region.techzone-services.com"),"\nwhere ",l.createElement(t.code,null,"00000")," is the port number and ",l.createElement(t.code,null,"region")," is the region that matches the IBM\nTechZone reservation provided values."),"\n",l.createElement(t.li,null,l.createElement(t.strong,null,"Jupyter Notebook Server")," - ",l.createElement(t.code,null,"http://region.techzone-services.com:00000/notebooks/Table_of_Contents.ipynb")," where ",l.createElement(t.code,null,"00000")," is the port\nnumber that matches the IBM TechZone reservation provided value."),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/1.jpg",alt:""}),"\n"),l.createElement(t.section,{className:"heading","data-heading-rank":"2","aria-labelledby":"start-watsonxdata"},l.createElement(t.h2,{id:"start-watsonxdata"},l.createElement(t.a,{href:"#start-watsonxdata"},"Start watsonx.data")),"\n",l.createElement(t.ol,null,"\n",l.createElement(t.li,null,"\n",l.createElement(t.p,null,"Open a terminal window on your laptop and enter the watsonx.data SSH command provided in your TechZone reservation ",l.createElement(t.strong,null,'"Published services"')," information."),"\n"),"\n",l.createElement(t.li,null,"\n",l.createElement(t.p,null,"The SSH command is:"),"\n"),"\n"),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"hljs language-bash"},"ssh -p watsonx@region.techzone-services.com\n")),"\n",l.createElement(t.blockquote,null,"\n",l.createElement(t.p,null,"The port number and region information must match the IBM TechZone reservation services provided to you for the SSH command to work"),"\n"),"\n",l.createElement(t.blockquote,null,"\n",l.createElement(t.p,null,"If a prompt about providing a fingerprint is displayed, type ",l.createElement(t.strong,null,"yes"),". This will close the SSH connection. Enter the command again and this message will not be repeated."),"\n"),"\n",l.createElement(t.p,null,"Enter ",l.createElement(t.strong,null,"watsonx.data")," as the password when prompted. This password you type will be invisible on the terminal."),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/2.png",alt:""}),"\n",l.createElement(t.ol,{start:"3"},"\n",l.createElement(t.li,null,"\n",l.createElement(t.p,null,"Enter the ",l.createElement(t.code,null,"sudo su -")," command to change your current user to root"),"\n"),"\n",l.createElement(t.li,null,"\n",l.createElement(t.p,null,"As the root user, change the current directory to the path ",l.createElement(t.code,null,"/root/ibm-lh-dev/bin")),"\n"),"\n"),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"hljs language-bash"},"sudo su -\n",l.createElement(t.span,{className:"hljs-built_in"},"cd")," /root/ibm-lh-dev/bin\n")),"\n",l.createElement(t.blockquote,null,"\n",l.createElement(t.p,null,"After changing to the root user, you will see the root prefix on every commnad line and # symbol prefacing the command line. For example:"),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/3.png",alt:""}),"\n",l.createElement(t.ol,{start:"5"},"\n",l.createElement(t.li,null,"Check the status of watsonx.data to ensure everything has started and is running by entering the ",l.createElement(t.code,null,"./status.sh --all")," command."),"\n"),"\n",l.createElement(t.blockquote,null,"\n",l.createElement(t.p,null,'There are two dashes ("-") in front of the "all" keyword.'),"\n"),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"hljs language-bash"},"./status.sh --all\n")),"\n",l.createElement(t.ol,{start:"6"},"\n",l.createElement(t.li,null,"The output from the command line should be comparable to the example below (widening the terminal window will make the output more readable). If all services are listed as ",l.createElement(t.em,null,"running"),", watsonx.data has started successfully."),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/4.jpg",alt:""}),"\n",l.createElement(t.ol,{start:"7"},"\n",l.createElement(t.li,null,l.createElement(t.strong,null,"Keep the terminal window open")," and proceed to the next section of the exercise."),"\n"),"\n"),l.createElement(t.section,{className:"heading","data-heading-rank":"2","aria-labelledby":"start-the-jupyter-notebook-table-of-contents"},l.createElement(t.h2,{id:"start-the-jupyter-notebook-table-of-contents"},l.createElement(t.a,{href:"#start-the-jupyter-notebook-table-of-contents"},"Start the Jupyter Notebook Table of Contents")),"\n",l.createElement(t.p,null,"The IBM TechZone image contains a Jupyter Notebook table of contents that makes it easy to access the Apache Spark notebook used by this lab."),"\n",l.createElement(t.ol,null,"\n",l.createElement(t.li,null,"Open a web browser (Google Chrome and Mozilla Firefox have been tested and work with this lab) and go to the ",l.createElement(t.strong,null,"Jupyter Notebook - Server URL")," that you recorded earlier from the ",l.createElement(t.strong,null,"Published Services")," section of your TechZone reservation."),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/5.png",alt:""}),"\n",l.createElement(t.ol,{start:"2"},"\n",l.createElement(t.li,null,"Scroll to the bottom of the browser window until you see the ",l.createElement(t.strong,null,"Setup a Password")," section. Your browser window should now show the ",l.createElement(t.strong,null,"Token")," and ",l.createElement(t.strong,null,"New Passwords")," fields along with a ",l.createElement(t.strong,null,"Log in and set new password")," button. Leave your browser window open and proceed to the next step."),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/6.png",alt:""}),"\n",l.createElement(t.ol,{start:"3"},"\n",l.createElement(t.li,null,"Return to the terminal window that you were instructed to keep open earlier. Enter the command ",l.createElement(t.code,null,"jupyter server list")),"\n"),"\n",l.createElement(t.pre,null,l.createElement(t.code,{className:"hljs language-bash"},"jupyter server list\n")),"\n",l.createElement(t.ol,{start:"4"},"\n",l.createElement(t.li,null,"Copy the token value from the first item in the command output"),"\n"),"\n",l.createElement(t.blockquote,null,"\n",l.createElement(t.p,null,"The token value is ",l.createElement(t.strong,null,"watsonx.data")),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/7.jpg",alt:""}),"\n",l.createElement(t.ol,{start:"5"},"\n",l.createElement(t.li,null,"Return to the browser window that you were instructed to keep open and path the ",l.createElement(t.strong,null,"same")," token value into both the ",l.createElement(t.strong,null,"Token")," and ",l.createElement(t.strong,null,"New Password")," fields within the browser window. Then select the ",l.createElement(t.strong,null,"Log in and set new password")," button."),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/8.png",alt:""}),"\n",l.createElement(t.ol,{start:"6"},"\n",l.createElement(t.li,null,"This lab's Jupyter Table of Contents is now displayed."),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/9.png",alt:""}),"\n",l.createElement(t.ol,{start:"7"},"\n",l.createElement(t.li,null,"Scroll down to the table of contents ",l.createElement(t.strong,null,'"Accessing watsonx.data with Python, Pandas, and Apache Spark"')," section. Click on the blue arrow in the lower right of the ",l.createElement(t.strong,null,'"Accessing watsonx.data with Spark"')," tile."),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/10.png",alt:""}),"\n",l.createElement(t.ol,{start:"8"},"\n",l.createElement(t.li,null,"The Jupyter Notebook for this lab that has the Spark code is now displayed in the browser window. The second section, ",l.createElement(t.strong,null,"Watsonx.data Development Systems Updates"),", details all the items that were changed to allow Apache Spark to run in the watsonx.data  Development Lab image. Since this is the image that is being used for this lab exercise, these changes are already in effect, and there is nothing you need to do to run Spark in this notebook."),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/11.jpg",alt:""}),"\n"),l.createElement(t.section,{className:"heading","data-heading-rank":"2","aria-labelledby":"using-apache-spark-within-a-jupyter-notebook-with-watsonxdata"},l.createElement(t.h2,{id:"using-apache-spark-within-a-jupyter-notebook-with-watsonxdata"},l.createElement(t.a,{href:"#using-apache-spark-within-a-jupyter-notebook-with-watsonxdata"},"Using Apache Spark within a Jupyter Notebook with watsonx.data")),"\n",l.createElement(t.p,null,"In this section, Apache Spark workflows and commands will be executed within a Jupyter Notebook with watsonx.data as the lakehouse."),"\n",l.createElement(t.ol,null,"\n",l.createElement(t.li,null,"Scroll down to the ",l.createElement(t.strong,null,"Copy Spark Libraries")," section. Note how executable (code) cells in Jupyter Notebooks are highlighted with a grey rectangle."),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/12.png",alt:""}),"\n",l.createElement(t.ol,{start:"2"},"\n",l.createElement(t.li,null,"A Jupyter Notebook cell can be executed using two methods:"),"\n"),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"Executing individual cells by clicking the ",l.createElement(t.strong,null,"Run icon")," (looks like a play button) in the menu bar at the top of the notebook."),"\n",l.createElement(t.li,null,"Executing the entire notebook by clicking on the ",l.createElement(t.strong,null,"Fast Forward")," icon"),"\n"),"\n",l.createElement(t.blockquote,null,"\n",l.createElement(t.p,null,"As an alternative to the menu icon, a single cell can also be run by using the ",l.createElement(t.strong,null,"Shift + Enter")," key macro while the cell is selected."),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/13.png",alt:""}),"\n",l.createElement(t.ol,{start:"3"},"\n",l.createElement(t.li,null,"Select the first code cell. Notice that the current cell position is highlighted with a solid blue bar on the left of the cell."),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/14.png",alt:""}),"\n",l.createElement(t.ol,{start:"4"},"\n",l.createElement(t.li,null,"Execute this first code cell"),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/15.png",alt:""}),"\n",l.createElement(t.ol,{start:"5"},"\n",l.createElement(t.li,null,"After executing a code cell, you should notice two differences in the notebook code cell:"),"\n"),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"The ",l.createElement(t.strong,null,"[]")," to the left of the cell will change to ",l.createElement(t.strong,null,"[*]")," during its execution."),"\n",l.createElement(t.li,null,"When execution completes, the cell changes to ",l.createElement(t.strong,null,"[n]")," where the number (n) is equivalent to the order that the cells were run"),"\n",l.createElement(t.li,null,"Output is displayed directly underneath the code cell (if an error or warning occurs, they will be displayed underneath the cell as well)."),"\n"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/16.png",alt:""}),"\n",l.createElement(t.ol,{start:"6"},"\n",l.createElement(t.li,null,"Run all the remaining code cells in order within the Jupyter Notebook, waiting for each cell to complete before running the next code cell."),"\n"),"\n",l.createElement(n,{text:"There is a quiz question related to what tasks can be performed with the Spark Engine."}),"\n",l.createElement(t.blockquote,null,"\n",l.createElement(t.p,null,"It is best practice to wait until the ",l.createElement(t.strong,null,"[*]")," for code cells being run changes to a number indicating the cell processing has completed. This is since some cells depend on the output from previous cells. For example, if a Python library is need for a function, until the library is loaded, trying to call the function will fail."),"\n"),"\n",l.createElement(t.blockquote,null,"\n",l.createElement(t.p,null,"Executing markup (text or documentation) cell within a notebook is ok, but there will be no output or run time allocated to these types of cells."),"\n"),"\n",l.createElement(t.p,null,"To get an idea of what these cells are doing when creating the various tables via SQL here's a screenshot of the ",l.createElement(t.strong,null,"Data manager")," within the watsonx.data web console after running the cells:"),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/16-1.png",alt:""}),"\n",l.createElement(t.p,null,"This Jupyter Notebook created buckets, tables, loaded data, and performed queries using Spark. The final product of the notebook execution cleans up the environment, all the work that has been done will be cleaned up and the storage bucket will be deleted."),"\n",l.createElement(t.img,{src:"https://raw.githubusercontent.com/ibm-build-lab/VAD-VAR-Workshop/main/content//Watsonx/WatsonxData/images/201/17.png",alt:""}),"\n"),l.createElement(t.section,{className:"heading","data-heading-rank":"2","aria-labelledby":"summary"},l.createElement(t.h2,{id:"summary"},l.createElement(t.a,{href:"#summary"},"Summary")),"\n",l.createElement(t.p,null,"You have now completed the lab!"),"\n",l.createElement(t.p,null,"In this lab, you used Apache Spark to create a storage bucket, create tables, load data, and perform queries against those tables using Spark SQL. Finally, after the lab exercise the watsonx.data environment was cleaned up by deleting the data and removing the storage bucket.")))}var r=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,a.ah)(),e.components);return t?l.createElement(t,e,l.createElement(o,e)):o(e)};var s=n(94184),i=n.n(s),c=n(24690),m=n(81140),h=n(48623),u=n(88531),d=n(13383),p=n(27315);const b=e=>{const{data:{mdx:{tableOfContents:{items:t},frontmatter:{toc:n=!0,title:a,timeToComplete:o,updated:r}}},children:s}=e,c=(0,l.useRef)(null),{0:b}=(0,l.useState)(""),g=(null===n||n)&&t;return l.createElement(l.Fragment,null,l.createElement(m.Z,{timeToComplete:o,updated:r},t[0].title||a||""),l.createElement(u.Z,{className:p.YS},l.createElement("article",{className:i()(p.Y2,!g&&p.ey),ref:c},l.createElement(h.Z,{components:{h1:()=>null}},s)),g&&l.createElement(d.Z,{itemsList:t,maxDepth:2,currSection:b})))},g=e=>{const{location:{pathname:t},data:{mdx:{frontmatter:{title:n},tableOfContents:{items:a}}}}=e;return l.createElement(c.Z,{pathname:t,title:n||a[0].title||void 0})};function E(e){return l.createElement(b,e,l.createElement(r,e))}}}]);
//# sourceMappingURL=component---src-pages-mdx-fields-slug-tsx-content-file-path-content-watsonx-watsonx-data-level-4-201-md-db96177f4c7b118428e0.js.map